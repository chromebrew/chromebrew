---
name: Generate Updates PR
on:
  schedule:
    - cron: '0 0 * * *'  # Daily
  workflow_dispatch:
env:
  GH_TOKEN: ${{ secrets.CREW_PR_TOKEN }}  # setting GH_TOKEN for the entire workflow
permissions:                    # Global permissions configuration starts here
  actions: write
  contents: write
  packages: write
  pull-requests: write          # 'write' access to pull requests
jobs:
  update-check:
    if: ${{ github.repository_owner == 'chromebrew' }}
    runs-on: ubuntu-24.04
    steps:
      - name: Check for updates in pip packages.
        id: pip-update-checks
        run: |
          gh workflow -R chromebrew/chromebrew run Updater-on-Demand.yml -f version_cmd_input="py3_*"
      - name: Check for updates in ruby gem packages.
        id: gem-update-checks
        run: |
          gh workflow -R chromebrew/chromebrew run Updater-on-Demand.yml -f version_cmd_input="ruby_*"
